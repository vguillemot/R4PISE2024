[
  {
    "objectID": "pages/G_PLSRonWines_part2.html",
    "href": "pages/G_PLSRonWines_part2.html",
    "title": "PLSR on Wines (Part 2)",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/G_PLSRonWines_part2.html#load-the-course-library",
    "href": "pages/G_PLSRonWines_part2.html#load-the-course-library",
    "title": "PLSR on Wines (Part 2)",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/G_PLSRonWines_part2.html#load-the-data",
    "href": "pages/G_PLSRonWines_part2.html#load-the-data",
    "title": "PLSR on Wines (Part 2)",
    "section": "Load the data",
    "text": "Load the data\nWith the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")\n\nMore information on the dataset is available on the corresponding vignette: vignette(\"A3_DataWines\")."
  },
  {
    "objectID": "pages/G_PLSRonWines_part2.html#two-tables-with-descriptors-and-other-supplementary-information",
    "href": "pages/G_PLSRonWines_part2.html#two-tables-with-descriptors-and-other-supplementary-information",
    "title": "PLSR on Wines (Part 2)",
    "section": "Two tables with descriptors and other supplementary information",
    "text": "Two tables with descriptors and other supplementary information\n\ndescr &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(origin, color, varietal)\nsuppl &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Price)\nchemi &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Acidity, Alcohol, Sugar, Tannin)\nsenso &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(fruity, floral, vegetal, \n           spicy, woody, sweet, astringent)\nhedo &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(hedonic)\n\n\nPLS-R: Two data tables\n\nThe predictor table (X): chemical data (chemi) that includes acidity, alcohol, sugar, and tannin.\nThe predicted table (Y): sensory data (senso) that includes fruity, floral, vegetal, spicy, woody, sweet, and astringent.\n\n\n\nDescriptors and supplementary variable\n\nDescriptors: origin, color and varietal.\nSupplementary variables: Price."
  },
  {
    "objectID": "pages/G_PLSRonWines_part2.html#run-partial-least-square-regression-pls-r-on-the-two-tables",
    "href": "pages/G_PLSRonWines_part2.html#run-partial-least-square-regression-pls-r-on-the-two-tables",
    "title": "PLSR on Wines (Part 2)",
    "section": "Run Partial Least Square Regression (PLS-R) on the two tables",
    "text": "Run Partial Least Square Regression (PLS-R) on the two tables\nThe data4PCCAR::PLSR_SVD function takes two entries of data tables. The first entry will be the predictor table (X) and the second entry will be the predicted table (Y) as in a regression equation: \\(\\mathbf{Y = \\beta X + E}\\). In RA, the dimensions maximize \\(\\beta\\) of each pair of latent variables.\n\nres.plsr &lt;- data4PCCAR::PLSR_SVD(chemi, senso, 3, inference = TRUE, displayJack = TRUE)\n\nThe function will center (to have means equal 0) and scale (to have the standard deviation equal 1) all variables in both data tables."
  },
  {
    "objectID": "pages/G_PLSRonWines_part2.html#generate-the-figures",
    "href": "pages/G_PLSRonWines_part2.html#generate-the-figures",
    "title": "PLSR on Wines (Part 2)",
    "section": "Generate the figures",
    "text": "Generate the figures\n\n## You might need to load these packages if the error is saying that it couldn't find some functions\n# library(PTCA4CATA) \n# library(data4PCCAR)\nres.plsr.plot &lt;- PLSRplot(\n    res = res.plsr, # Output of tepPLS\n    displayJack = TRUE,\n    color.obs = wineColors, # &lt;optional&gt; colors of wines\n    color.tab = varColors, # &lt;optional&gt; colors of the two tables\n    tab1.name = \"Chemical data\", # &lt;optional&gt; Name of Table 1 (for printing)\n    tab2.name = \"Sensory data\", # &lt;optional&gt; Name of Table 2 (for printing)\n    DESIGN = descr$color, # design for the wines\n    tab1 = chemi,  # First data table\n    tab2 = senso)  # Second data table\n\nIn this PLSRplot function, if DESIGN is specified. The latent variables will be colored according to the groups of the observations with the group means and their 95% bootstrap confidence intervals.\n\nCorrelation between the two tables\nWe can check the data by plotting first the correlation matrix between the two data sets. This correlation matrix is where the dimensions are extracted.\n\nres.plsr.plot$results.graphs$heatmap.rxy\n\n\n\n\n\n\n\n\n\n\nScree plot\nThe scree plot shows the eigenvalues of each dimension. These eigenvalues give the squared coefficient of regression (\\(\\beta^2\\) = ) of each pair of latent variables. In other words, the singular values, which are the square root of the eigenvalues, give the coefficient of regression (\\(\\beta\\) = ) of these pairs of latent variables. The sum of the eigenvalues is equal to the sum of the squared correlation between all variables in both tables.\n\nres.plsr.plot$results.graphs$scree.eig.R2X\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$scree.eig.R2Y\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$scree.sv.R2X\n#&gt; NULL\nres.plsr.plot$results.graphs$scree.sv.R2Y\n#&gt; NULL\nres.plsr.plot$results.graphs$Y.RESS.plot\n\n\n\n\n\n\n\n\n\n\nLatent variables\nHere, we plot the first latent variable of both tables against each other with the observations colored according to their groups. This plot shows how the observations are distributed on the dimension and how the chosen pair of latent variables are related to each other. When plotting the first pair of latent variables, we expect the observations to distribute along the bottom-left-to-top-right diagonal line (which illustrates a perfect association), because RA maximizes the coefficient of regression of the latent variables.\nTo examine the stability of these groups, we plot the group means with their 95% bootstrap confidence intervals (or ellipsoids). If the ellipses do not overlap, the groups are reliably different from each other. However, it’s worth noted that the distribution of the observations does not imply how the groups (represented by the group means) are distributed or whether the groups are reliably different from each other.\nNote: The grouping information are independent from RA and are only use to help provide a summary description of the observations.\n\nres.plsr.plot$results.graphs$lv.plot\n\n\n\n\n\n\n\n\nThe results from Dimension 1 show that the chemical data can predict the performance of the sensory data, and such prediction separates the red wines from the rosé and the white wines, but not the rosé and the white.\n\n\nContributions\nThese bar plots illustrate the signed contribution of variables from the two data tables. From these figures, we use the direction and the magnitude of these signed contributions to interpret the dimension.\nThe direction of the signed contribution is the direction of the loadings, and it shows how the variables contribute to the dimension. The variables that contribute in a similar way have the same sign, and those that contribute in an opposite way will have different signs.\nThe magnitude of the contributions are computed as squared loadings, and they quantify the amount of variance contributed by each variable. Therefore, contribution is similar to the idea of an effect size. To identify the important variables, we find the variables that contribute more than average (i.e., with a big enough effect size). When the variables are centered and scaled to have their sums of squares equals 1, each variable contributes one unit of variance; therefore, the average contribution is 1/(# of variables of the table).\n\nres.plsr.plot$results.graphs$ctrW1.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$ctrW2.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$LoadingsMap.X\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$ctrC1.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$ctrC2.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$LoadingsMap.Y\n\n\n\n\n\n\n\n\nFrom these two bar plots, the first dimension is characterized by (1) the positive association between Alcohol and Tannin from the Chemical data and Woody and Astringent from the Sensory data, and (2) the negative association between these variables and Hedonic from the Sensory data.\nTogether with the latent variable plot, we found that, as compared to the rosé and the white wines in the sample, the red wines are less Hedonic and stronger in Alcohol, Tannin, Woody, and Astringent.\n\n\nCircles of correlations\nThe circle of correlations illustrate how the variables are correlated with each other and with the dimensions. From this figure, the length of an arrow indicates how much this variable is explained by the two given dimensions. The cosine between any two arrows gives their correlation. The cosine between a variable and an axis gives the correlation between that variable and the corresponding dimension.\nIn this figure, an angle closer to 0° indicates a correlation close to 1; an angle closer to 180° indicates a correlation close to -1; and an 90° angle indicates 0 correlation. However, it’s worth noted that this implication of correlation might only be true within the given dimensions. When a variable is far away from the circle, it is not fully explained by the dimensions, and other dimensions might be characterized by other pattern of relationship between this and other variables.\n\nres.plsr.plot$results.graphs$heatmap.rty\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$cirCorY.plot\n\n\n\n\n\n\n\n\nThese circles of correlations show that Alcohol, Tannin, Woody, Astringent, and Hedonic are strongly correlated to Dimension 1 with Henodic inversely correlated with all other variables. These variables are mostly explained by the first dimension and have close-to-zero correlation with the second dimension (which is not included and discussed in the previous sections)."
  },
  {
    "objectID": "pages/G_PLSRonWines_part2.html#inference-plots-and-results",
    "href": "pages/G_PLSRonWines_part2.html#inference-plots-and-results",
    "title": "PLSR on Wines (Part 2)",
    "section": "Inference plots and results",
    "text": "Inference plots and results\n\nThe predicted residuals estimated sum of squares (PRESS) of Y (random effect)\n\nres.plsr.plot$results.graphs$Y.PRESS.plot"
  },
  {
    "objectID": "pages/A_DataWines.html",
    "href": "pages/A_DataWines.html",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "",
    "text": "With the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")"
  },
  {
    "objectID": "pages/A_DataWines.html#load-the-data",
    "href": "pages/A_DataWines.html#load-the-data",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "",
    "text": "With the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")"
  },
  {
    "objectID": "pages/A_DataWines.html#argentina",
    "href": "pages/A_DataWines.html#argentina",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "Argentina",
    "text": "Argentina\n\n\n\n\norigin\ncolor\nvarietal\nPrice\nAcidity\nAlcohol\nSugar\nTannin\nfruity\nfloral\nvegetal\nspicy\nwoody\nsweet\nastringent\nacidic\nhedonic\n\n\n\n\nA1\nArgentina\nred\nmerlot\n11\n5.33\n13.8\n2.75\n559\n6\n2\n1\n4\n5\n3\n5\n4\n2\n\n\nA2\nArgentina\nred\ncabernet\n5\n5.14\n13.9\n2.41\n672\n5\n3\n2\n3\n4\n2\n6\n3\n2\n\n\nA3\nArgentina\nred\nshiraz\n7\n5.16\n14.3\n2.20\n455\n7\n1\n2\n6\n5\n3\n4\n2\n2\n\n\nA4\nArgentina\nred\npinot\n16\n4.37\n13.5\n3.00\n348\n5\n3\n2\n2\n4\n1\n3\n4\n4\n\n\nA5\nArgentina\nwhite\nchardonnay\n14\n4.34\n13.3\n2.61\n46\n5\n4\n1\n3\n4\n2\n1\n4\n6\n\n\nA6\nArgentina\nwhite\nsauvignon\n8\n6.60\n13.3\n3.17\n54\n7\n5\n6\n1\n1\n4\n1\n5\n8\n\n\nA7\nArgentina\nwhite\nriesling\n9\n7.70\n12.3\n2.15\n42\n6\n7\n2\n2\n2\n3\n1\n6\n9\n\n\nA8\nArgentina\nwhite\ngewurzt\n11\n6.70\n12.5\n2.51\n51\n5\n8\n2\n1\n1\n4\n1\n4\n9\n\n\nA9\nArgentina\nrose\nmalbec\n4\n6.50\n13.0\n7.24\n84\n8\n4\n3\n2\n2\n6\n2\n3\n8\n\n\nA10\nArgentina\nrose\ncabernet\n3\n4.39\n12.0\n4.50\n90\n6\n3\n2\n1\n1\n5\n2\n3\n8\n\n\nA11\nArgentina\nrose\npinot\n6\n4.89\n12.0\n6.37\n76\n7\n2\n1\n1\n1\n4\n1\n4\n9\n\n\nA12\nArgentina\nrose\nsyrah\n5\n5.90\n13.5\n4.20\n80\n8\n4\n1\n3\n2\n5\n2\n3\n7"
  },
  {
    "objectID": "pages/A_DataWines.html#canada",
    "href": "pages/A_DataWines.html#canada",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "Canada",
    "text": "Canada\n\n\n\n\norigin\ncolor\nvarietal\nPrice\nAcidity\nAlcohol\nSugar\nTannin\nfruity\nfloral\nvegetal\nspicy\nwoody\nsweet\nastringent\nacidic\nhedonic\n\n\n\n\nC1\nCanada\nred\nmerlot\n20\n7.42\n14.9\n2.1\n483\n5\n3\n2\n3\n4\n3\n4\n4\n3\n\n\nC2\nCanada\nred\ncabernet\n15\n7.35\n14.5\n1.9\n698\n6\n3\n2\n2\n5\n2\n5\n4\n2\n\n\nC3\nCanada\nred\nshiraz\n20\n7.50\n14.5\n1.5\n413\n6\n2\n3\n4\n3\n3\n5\n1\n2\n\n\nC4\nCanada\nred\npinot\n25\n5.70\n13.3\n1.7\n320\n4\n2\n3\n1\n3\n2\n4\n4\n4\n\n\nC5\nCanada\nwhite\nchardonnay\n20\n6.00\n13.5\n3.0\n35\n4\n3\n2\n1\n3\n2\n2\n3\n5\n\n\nC6\nCanada\nwhite\nsauvignon\n15\n7.50\n12.0\n3.5\n40\n8\n4\n3\n2\n1\n3\n1\n4\n8\n\n\nC7\nCanada\nwhite\nriesling\n15\n7.00\n11.9\n3.4\n48\n7\n5\n1\n1\n3\n3\n1\n7\n8\n\n\nC8\nCanada\nwhite\ngewurzt\n18\n6.30\n13.9\n2.8\n39\n6\n5\n2\n2\n2\n3\n2\n5\n6\n\n\nC9\nCanada\nrose\nmalbec\n8\n5.90\n12.0\n5.5\n90\n6\n3\n3\n3\n2\n4\n2\n4\n8\n\n\nC10\nCanada\nrose\ncabernet\n6\n5.60\n12.5\n4.0\n85\n5\n4\n1\n3\n2\n4\n2\n4\n7\n\n\nC11\nCanada\nrose\npinot\n9\n6.20\n13.0\n6.0\n75\n5\n3\n2\n1\n2\n3\n2\n3\n7\n\n\nC12\nCanada\nrose\nsyrah\n9\n5.80\n13.0\n3.5\n83\n7\n3\n2\n3\n3\n4\n1\n4\n7"
  },
  {
    "objectID": "pages/A_DataWines.html#usa",
    "href": "pages/A_DataWines.html#usa",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "USA",
    "text": "USA\n\n\n\n\norigin\ncolor\nvarietal\nPrice\nAcidity\nAlcohol\nSugar\nTannin\nfruity\nfloral\nvegetal\nspicy\nwoody\nsweet\nastringent\nacidic\nhedonic\n\n\n\n\nU1\nUSA\nred\nmerlot\n25\n6.00\n13.6\n3.50\n578\n7\n2\n2\n5\n6\n3\n4\n3\n2\n\n\nU2\nUSA\nred\ncabernet\n15\n6.50\n14.6\n3.50\n710\n8\n3\n1\n4\n5\n3\n5\n3\n2\n\n\nU3\nUSA\nred\nshiraz\n25\n5.30\n13.9\n1.99\n610\n8\n2\n3\n7\n6\n4\n5\n3\n1\n\n\nU4\nUSA\nred\npinot\n28\n6.10\n14.0\n0.00\n340\n6\n3\n2\n2\n5\n2\n4\n4\n2\n\n\nU5\nUSA\nwhite\nchardonnay\n15\n7.20\n13.3\n1.10\n41\n6\n4\n2\n3\n6\n3\n2\n4\n5\n\n\nU6\nUSA\nwhite\nsauvignon\n8\n7.20\n13.5\n1.00\n50\n6\n5\n5\n1\n2\n4\n2\n4\n7\n\n\nU7\nUSA\nwhite\nriesling\n10\n8.60\n12.0\n1.65\n47\n5\n5\n3\n2\n2\n4\n2\n5\n8\n\n\nU8\nUSA\nwhite\ngewurzt\n20\n9.60\n12.0\n0.00\n45\n6\n6\n3\n2\n2\n4\n2\n3\n8\n\n\nU9\nUSA\nrose\nmalbec\n3\n6.20\n12.5\n4.00\n84\n8\n2\n1\n4\n3\n5\n2\n4\n7\n\n\nU10\nUSA\nrose\ncabernet\n4\n5.71\n12.5\n4.30\n93\n8\n3\n3\n3\n2\n6\n2\n3\n8\n\n\nU11\nUSA\nrose\npinot\n8\n5.40\n13.0\n3.10\n79\n6\n1\n1\n2\n3\n4\n1\n3\n6\n\n\nU12\nUSA\nrose\nsyrah\n6\n6.50\n13.5\n3.00\n89\n9\n3\n2\n5\n4\n3\n2\n3\n5"
  },
  {
    "objectID": "pages/A_DataWines.html#four-tables",
    "href": "pages/A_DataWines.html#four-tables",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "Four tables",
    "text": "Four tables\n\nDescriptors: origin, color and varietal;\nSuplementary variables: Price;\nChemical data: Acidity, Alcohol, Sugar, and Tannin;\nSensory data: fruity, floral, vegetal, spicy, woody, sweet, astringent, and hedonic."
  },
  {
    "objectID": "pages/A_DataWines.html#the-sensory-scores",
    "href": "pages/A_DataWines.html#the-sensory-scores",
    "title": "A Sensory Data Set on Wines of The World",
    "section": "The sensory scores",
    "text": "The sensory scores"
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html",
    "href": "pages/F_PLSRonWines_part1.html",
    "title": "PLSR on Wines (Part 1)",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html#load-the-course-library",
    "href": "pages/F_PLSRonWines_part1.html#load-the-course-library",
    "title": "PLSR on Wines (Part 1)",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html#load-the-data",
    "href": "pages/F_PLSRonWines_part1.html#load-the-data",
    "title": "PLSR on Wines (Part 1)",
    "section": "Load the data",
    "text": "Load the data\nWith the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")\n\nMore information on the dataset is available on the corresponding vignette: vignette(\"A3_DataWines\")."
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html#two-tables-with-descriptors-and-other-supplementary-information",
    "href": "pages/F_PLSRonWines_part1.html#two-tables-with-descriptors-and-other-supplementary-information",
    "title": "PLSR on Wines (Part 1)",
    "section": "Two tables with descriptors and other supplementary information",
    "text": "Two tables with descriptors and other supplementary information\n\ndescr &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(origin, color, varietal)\nsuppl &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Price)\nchemi &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Acidity, Alcohol, Sugar, Tannin)\nsenso &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(fruity, floral, vegetal, \n           spicy, woody, sweet, astringent)\nchemisenso &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Acidity, Alcohol, Sugar, Tannin, fruity, floral, vegetal,\n           spicy, woody, sweet, astringent)\nhedo &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(hedonic)\n\n\nPLS-R Part 1: Predicting one variable with a data table\n\nThe predictors (X): chemical data (chemi) that includes acidity, alcohol, sugar, and tannin.\nThe predicted (Y): hedonic (hedo).\n\n\n\nDescriptors and supplementary variable\n\nDescriptors: origin, color and varietal.\nSupplementary variables: Price."
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html#run-partial-least-square-regression-pls-r-on-the-two-tables",
    "href": "pages/F_PLSRonWines_part1.html#run-partial-least-square-regression-pls-r-on-the-two-tables",
    "title": "PLSR on Wines (Part 1)",
    "section": "Run Partial Least Square Regression (PLS-R) on the two tables",
    "text": "Run Partial Least Square Regression (PLS-R) on the two tables\nThe data4PCCAR::PLSR_SVD function takes two entries of data tables. The first entry will be the predictor table (X) and the second entry will be the predicted table (Y) as in a regression equation: \\(\\mathbf{Y = \\beta X + E}\\). In RA, the dimensions maximize \\(\\beta\\) of each pair of latent variables.\n\nres.plsr &lt;- data4PCCAR::PLSR_SVD(chemi, hedo, 3, inference = TRUE, displayJack = TRUE)\n\nThe function will center (to have means equal 0) and scale (to have the standard deviation equal 1) all variables in both data tables."
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html#generate-the-figures",
    "href": "pages/F_PLSRonWines_part1.html#generate-the-figures",
    "title": "PLSR on Wines (Part 1)",
    "section": "Generate the figures",
    "text": "Generate the figures\n\n## You might need to load these packages if the error is saying that it couldn't find some functions\n# library(PTCA4CATA) \n# library(data4PCCAR)\nres.plsr.plot &lt;- PLSRplot(\n    res = res.plsr, # Output of tepPLS\n    displayJack = TRUE,\n    color.obs = wineColors, # &lt;optional&gt; colors of wines\n    color.tab = varColors, # &lt;optional&gt; colors of the two tables\n    tab1.name = \"Chemical data\", # &lt;optional&gt; Name of Table 1 (for printing)\n    tab2.name = \"Hedonic\", # &lt;optional&gt; Name of Table 2 (for printing)\n    DESIGN = descr$color, # design for the wines\n    tab1 = chemi,  # First data table\n    tab2 = hedo)  # Second data table\n\nIn this PLSRplot function, if DESIGN is specified. The latent variables will be colored according to the groups of the observations with the group means and their 95% bootstrap confidence intervals.\n\nCorrelation between the two tables\nWe can check the data by plotting first the correlation matrix between the two data sets. This correlation matrix is where the dimensions are extracted.\n\nres.plsr.plot$results.graphs$heatmap.rxy\n\n\n\n\n\n\n\n\n\n\nScree plot\nThe scree plot shows the eigenvalues of each dimension. These eigenvalues give the squared coefficient of regression (\\(\\beta^2\\) = NA) of each pair of latent variables. In other words, the singular values, which are the square root of the eigenvalues, give the coefficient of regression (\\(\\beta\\) = NA) of these pairs of latent variables. The sum of the eigenvalues is equal to the sum of the squared correlation between all variables in both tables.\n\nres.plsr.plot$results.graphs$scree.eig.R2X\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$scree.eig.R2Y\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$scree.sv.R2X\n#&gt; NULL\nres.plsr.plot$results.graphs$scree.sv.R2Y\n#&gt; NULL\nres.plsr.plot$results.graphs$Y.RESS.plot\n\n\n\n\n\n\n\n\n\n\nThe prediction (fixed effect)\n\nres.plsr.plot$results.graphs$YYhat.plot\n\n\n\n\n\n\n\n\n\n\nLatent variables\nHere, we plot the first latent variable of both tables against each other with the observations colored according to their groups. This plot shows how the observations are distributed on the dimension and how the chosen pair of latent variables are related to each other. When plotting the first pair of latent variables, we expect the observations to distribute along the bottom-left-to-top-right diagonal line (which illustrates a perfect association), because RA maximizes the coefficient of regression of the latent variables.\nTo examine the stability of these groups, we plot the group means with their 95% bootstrap confidence intervals (or ellipsoids). If the ellipses do not overlap, the groups are reliably different from each other. However, it’s worth noted that the distribution of the observations does not imply how the groups (represented by the group means) are distributed or whether the groups are reliably different from each other.\nNote: The grouping information are independent from RA and are only use to help provide a summary description of the observations.\n\nres.plsr.plot$results.graphs$lv.plot\n\n\n\n\n\n\n\n\nThe results from Dimension 1 show that the chemical data can predict the performance of the sensory data, and such prediction separates the red wines from the rosé and the white wines, but not the rosé and the white.\n\n\nContributions\nThese bar plots illustrate the signed contribution of variables from the two data tables. From these figures, we use the direction and the magnitude of these signed contributions to interpret the dimension.\nThe direction of the signed contribution is the direction of the loadings, and it shows how the variables contribute to the dimension. The variables that contribute in a similar way have the same sign, and those that contribute in an opposite way will have different signs.\nThe magnitude of the contributions are computed as squared loadings, and they quantify the amount of variance contributed by each variable. Therefore, contribution is similar to the idea of an effect size. To identify the important variables, we find the variables that contribute more than average (i.e., with a big enough effect size). When the variables are centered and scaled to have their sums of squares equals 1, each variable contributes one unit of variance; therefore, the average contribution is 1/(# of variables of the table).\n\nres.plsr.plot$results.graphs$ctrW1.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$ctrW2.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$LoadingsMap.X\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$ctrC1.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$ctrC2.plot\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$LoadingsMap.Y\n\n\n\n\n\n\n\n\nFrom these two bar plots, the first dimension is characterized by (1) the positive association between Alcohol and Tannin from the Chemical data and Woody and Astringent from the Sensory data, and (2) the negative association between these variables and Hedonic from the Sensory data.\nTogether with the latent variable plot, we found that, as compared to the rosé and the white wines in the sample, the red wines are less Hedonic and stronger in Alcohol, Tannin, Woody, and Astringent.\n\n\nCircles of correlations\nThe circle of correlations illustrate how the variables are correlated with each other and with the dimensions. From this figure, the length of an arrow indicates how much this variable is explained by the two given dimensions. The cosine between any two arrows gives their correlation. The cosine between a variable and an axis gives the correlation between that variable and the corresponding dimension.\nIn this figure, an angle closer to 0° indicates a correlation close to 1; an angle closer to 180° indicates a correlation close to -1; and an 90° angle indicates 0 correlation. However, it’s worth noted that this implication of correlation might only be true within the given dimensions. When a variable is far away from the circle, it is not fully explained by the dimensions, and other dimensions might be characterized by other pattern of relationship between this and other variables.\n\nres.plsr.plot$results.graphs$heatmap.rty\n\n\n\n\n\n\n\nres.plsr.plot$results.graphs$cirCorY.plot\n\n\n\n\n\n\n\n\nThese circles of correlations show that Alcohol, Tannin, Woody, Astringent, and Hedonic are strongly correlated to Dimension 1 with Henodic inversely correlated with all other variables. These variables are mostly explained by the first dimension and have close-to-zero correlation with the second dimension (which is not included and discussed in the previous sections)."
  },
  {
    "objectID": "pages/F_PLSRonWines_part1.html#inference-plots-and-results",
    "href": "pages/F_PLSRonWines_part1.html#inference-plots-and-results",
    "title": "PLSR on Wines (Part 1)",
    "section": "Inference plots and results",
    "text": "Inference plots and results\n\nThe prediction (random effect)\n\nres.plsr.plot$results.graphs$YYjack.plot\n\n\n\n\n\n\n\n\n\n\nThe predicted residuals estimated sum of squares (PRESS) of Y (random effect)\n\nres.plsr.plot$results.graphs$Y.PRESS.plot"
  },
  {
    "objectID": "pages/B_PCAonWines.html",
    "href": "pages/B_PCAonWines.html",
    "title": "PCA on Beers",
    "section": "",
    "text": "In this vignette we show how to perform a principal component analysis"
  },
  {
    "objectID": "pages/B_PCAonWines.html#load-the-libraries",
    "href": "pages/B_PCAonWines.html#load-the-libraries",
    "title": "PCA on Beers",
    "section": "Load the libraries",
    "text": "Load the libraries\nThe following code loads the libraries needed for the analysis:\n\nlibrary(dplyr)\nlibrary(ExPosition)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(InPosition)\nset.seed(564)"
  },
  {
    "objectID": "pages/B_PCAonWines.html#load-the-data",
    "href": "pages/B_PCAonWines.html#load-the-data",
    "title": "PCA on Beers",
    "section": "Load the data",
    "text": "Load the data\nThe data for this example come from the package data4PCCAR (which is loaded with the present package). The following commands get the data:\n\n\nlibrary(R4SPISE2022)\ndata(\"sixBeers12Descriptors10Judges\", package = \"data4PCCAR\")\nbeers &lt;- sixBeers12Descriptors10Judges$ratingsIntensity\nbeerColors &lt;- sixBeers12Descriptors10Judges$color4Products\ndescColors &lt;- sixBeers12Descriptors10Judges$color4Descriptors\n\nThese data comprise three items\n\nbeers: the ratings (a data frame with intensity ratings);\nbeerColors: a vector with the names of the colors for the beers;\ndescColors: a vector with the names of the colors for the descriptors.\n\nMore information on the dataset is available on the corresponding vignette: vignette(\"A1_DataBeers\")."
  },
  {
    "objectID": "pages/B_PCAonWines.html#run-the-principal-component-analysis-pca",
    "href": "pages/B_PCAonWines.html#run-the-principal-component-analysis-pca",
    "title": "PCA on Beers",
    "section": "Run the Principal Component Analysis (PCA)",
    "text": "Run the Principal Component Analysis (PCA)\n\nres.pca &lt;- epPCA(beers, \n                 center = TRUE, # Center the data\n                 scale = FALSE, # **Do not** scale the variables\n                 graphs = FALSE) \n\nBy default, this function will preprocess the variables in the darta set (i.e., the columns of the data table) by 1) centering them (option center = TRUE after pre-processing all variables have mean equals to 0) and 2) scaling them (option scale = TRUE after pre-processing all variables have a sum of squares equals to , being the number of rows)."
  },
  {
    "objectID": "pages/B_PCAonWines.html#plot-the-results",
    "href": "pages/B_PCAonWines.html#plot-the-results",
    "title": "PCA on Beers",
    "section": "Plot the results",
    "text": "Plot the results\n\nres.plot.pca &lt;- OTAplot(\n    resPCA = res.pca,\n    data = beers\n    )\n\n\nresults.stats: useful statistics after performing PCA, among which one can find the factor scores, loadings, eigenvalues, and contributions;\nresults.graphs: all the PCA graphs (heatmaps, screeplot, factor map, correlation circles, loading maps etc.)\ndescription.graphs: the titles of these graphs, used as titles in the PPTX file.\n\n\nCorrelations of the variables\nWe can check the data by plotting the correlation matrix between the variables. This correlation matrix is where the components are extracted.\n\nres.plot.pca$results.graphs$correlation\n\n\n\n\n\n\n\n\n\n\nScree plot\nThe scree plot shows the eigenvalues of each component. These eigenvalues give the variance of each component (or called dimension in the figure). In other words, the singular values, which are the square root of the eigenvalues, give the standard deviations of these components. The sum of the eigenvalues is equal to the total inertia of the data.\n\nres.plot.pca$results.graphs$scree\n\n\n\n\n\n\n\n\nAccording to the elbow test, there are four dimensions to keep for these data.\n\n\nFactor scores (rows)\nHere, the observation map shows how the observations (i.e., rows) are represented in the component space. If center = TRUE when running a PCA with epPCA, the origin is at the center (i.e., is the average / barycenter) of all observations. (If it’s not, something’s wrong)\n\nres.plot.pca$results.graphs$factorScoresI12\n\n\n\n\n\n\n\n\nThe result in this plot showed that the first dimension separates BlueMoon from Hofbrau, and the second dimension separates BlueMoon and Hofbrau from FranzDunkel and FranzNatur.\n\n\nCircle of correlation\nThe circle of correlations illustrate how the variables are correlated with each other and with the dimensions. From this figure, the length of an arrow indicates how much this variable is explained by the two given dimensions. The cosine between any two arrows gives their correlation. The cosine between a variable and an axis gives the correlation between that variable and the corresponding dimension.\nIn this figure, an angle closer to 0° indicates a correlation close to 1; an angle closer to 180° indicates a correlation close to -1; and an 90° angle indicates 0 correlation. However, it’s worth noted that this implication of correlation might only be true within the given dimensions. When a variable is far away from the circle, it is not fully explained by the dimensions, and other dimensions might be characterized by other pattern of relationship between this and other variables.\n\nres.plot.pca$results.graphs$cosineCircleArrowJ12\n\n\n\n\n\n\n\n\nThis circle of correlation plot illustrates that Dimension 1 is Sweet and Alcoholic versus Yeast, Hay, Bitter, Cereal, and Toasted; Dimension 2 is Acid and Fermented versus Cereal and Toasted. Interestingly, Acid and Fermented are orthogonal to Sweet and Hay (which are anti-correlated from each other) on the first two dimension. On these two dimensions, Cereal and Toasted are negatively correlated with Malt and Hop."
  },
  {
    "objectID": "pages/B_PCAonWines.html#inference-plots-and-results",
    "href": "pages/B_PCAonWines.html#inference-plots-and-results",
    "title": "PCA on Beers",
    "section": "Inference plots and results",
    "text": "Inference plots and results\nThe inference analysis of PCA (performed by OTAplotInference) includes bootstrap test of the proportion of variance explained, permutation tests of the eigenvalues, the bootstrap tests of the column factor scores \\(\\mathbf{G}\\) (i.e., the right singular vectors scaled to have the variance of each dimension equals the corresponding singular value; \\(\\mathbf{G} = \\mathbf{Q}\\boldsymbol{\\Delta}\\) with \\(\\mathbf{X = P}\\boldsymbol{\\Delta}\\mathbf{Q}^\\top\\)). These column factor scores are stored as fj in the output of epPCA.\n\nres.plot.pca.inference &lt;- OTAplotInference(\n    resPCA = res.pca,\n    data = beers\n    ) %&gt;% suppressMessages()\n\n\nBootstrap and permutation tests on the eigenvalues\nThe inference scree plot illustrates the 95% bootstrap confidence intervals of the percentage of variance explained by each eigenvalue. If an interval includes 0, the component explains reliably larger than 0% of the variance.\n\nres.plot.pca.inference$results.graphs$scree\n\n\n\n\n\n\n\n\nThe bootstrap test identifies one significant dimension explains the variance reliably larger than 0%. The permutation test identifies one significant dimension with an eigenvalue significantly larger than 0.\n\n\nBootstrap test on the column factor scores\nThe bar plot illustrates the bootstrap ratios which equals \\[\\frac{M_{g_{j}boot}}{SD_{g_{j}boot}},\\] where \\(M_{g_{j}boot}\\) is the mean of the bootstrapped sample of the jth column factor score and \\(SD_{g_{j}boot}\\) is the bootstrapped standard deviation of the factor score. A bootstrap ratio is equivalent to a t-statistics for the column factor score with the \\(\\mathrm{H}_0: g_j = 0\\). The threshold is set to 2 to approximate the critical t-value of 1.96 at \\(\\alpha\\) = .05.\n\nres.plot.pca.inference$results.graphs$BR1\n\n\n\n\n\n\n\n\n\nres.plot.pca.inference$results.graphs$BR2\n\n\n\n\n\n\n\n\nThe results show no significant factor scores for both dimensions that is reliably different from 0."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R4SPISE2024",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "pages/D_CCAonWines.html",
    "href": "pages/D_CCAonWines.html",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/D_CCAonWines.html#load-the-course-library",
    "href": "pages/D_CCAonWines.html#load-the-course-library",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/D_CCAonWines.html#load-the-data",
    "href": "pages/D_CCAonWines.html#load-the-data",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "Load the data",
    "text": "Load the data\nWith the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")\n\nMore information on the dataset is available on the corresponding vignette: vignette(\"A3_DataWines\")."
  },
  {
    "objectID": "pages/D_CCAonWines.html#two-tables-with-descriptors-and-other-supplementary-information",
    "href": "pages/D_CCAonWines.html#two-tables-with-descriptors-and-other-supplementary-information",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "Two tables with descriptors and other supplementary information",
    "text": "Two tables with descriptors and other supplementary information\n\ndescr &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(origin, color, varietal)\nsuppl &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Price)\nchemi &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Acidity, Alcohol, Sugar, Tannin)\nsenso &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(fruity, floral, vegetal, \n           spicy, woody, sweet, astringent, \n           hedonic)\n\n\nTwo data tables\n\nFirst table: chemical data (chemi) that includes acidity, alcohol, sugar, and tannin.\nSecond table: sensory data (senso) that includes fruity, floral, vegetal, spicy, woody, sweet, astringent, and hedonic.\n\n\n\nDescriptors and supplementary variable\n\nDescriptors: origin, color and varietal.\nSupplementary variables: Price."
  },
  {
    "objectID": "pages/D_CCAonWines.html#run-canonical-correlation-analysis-cca-on-the-two-tables",
    "href": "pages/D_CCAonWines.html#run-canonical-correlation-analysis-cca-on-the-two-tables",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "Run Canonical Correlation Analysis (CCA) on the two tables",
    "text": "Run Canonical Correlation Analysis (CCA) on the two tables\n\nres.cca &lt;- tepCCA(chemi, senso, DESIGN = descr$color, graphs = FALSE)\n\nThe default of this function will center (to have means equal 0) and scale (to have the sums of squares equal 1) all variables in both data tables. The argument DESIGN indicates the groups of the observations and change how the observations are colored in the figures (when graphs = TRUE), but it does not change the results of CCA."
  },
  {
    "objectID": "pages/D_CCAonWines.html#generate-the-figures",
    "href": "pages/D_CCAonWines.html#generate-the-figures",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "Generate the figures",
    "text": "Generate the figures\n\n## You might need to load these packages if the error is saying that it couldn't find some functions\n# library(PTCA4CATA) \n# library(data4PCCAR)\nres.cca.plot &lt;- TTAplot(\n    res = res.cca, # Output of tepPLS\n    color.obs = wineColors, # &lt;optional&gt; colors of wines\n    color.tab = varColors, # &lt;optional&gt; colors of the two tables\n    tab1.name = \"Chemical data\", # &lt;optional&gt; Name of Table 1 (for printing)\n    tab2.name = \"Sensory data\", # &lt;optional&gt; Name of Table 2 (for printing)\n    DESIGN = descr$color, # design for the wines\n    tab1 = chemi,  # First data table\n    tab2 = senso)  # Second data table\n\nIn this TTAplot function, if DESIGN is specified. The latent variables will be colored according to the groups of the observations with the group means and their 95% bootstrap confidence intervals.\n\nCorrelation between the two tables\nWe can check the data by plotting first the correlation matrix between the two data sets. This correlation matrix is where the dimensions are extracted.\n\nres.cca.plot$results.graphs$heatmap.rxy\n\n\n\n\n\n\n\n\n\n\nScree plot\nThe scree plot shows the eigenvalues of each dimension. These eigenvalues give the squared correlation (\\(R^2\\) = 0.9497911) of each pair of latent variables. In other words, the singular values, which are the square root of the eigenvalues, give the correlation (\\(r\\) = 0.9745723) of these pairs of latent variables. The sum of the eigenvalues is equal to the sum of the squared correlation between all variables in both tables.\n\nres.cca.plot$results.graphs$scree.eig\n\n\n\n\n\n\n\n\n\n\nLatent variables\nHere, we plot the first latent variable of both tables against each other with the observations colored according to their groups. This plot shows how the observations are distributed on the dimension and how the chosen pair of latent variables are related to each other. When plotting the first pair of latent variables, we expect the observations to distribute along the bottom-left-to-top-right diagonal line (which illustrates a perfect correlation), because CCA maximizes the correlation of the latent variables.\nTo examine the stability of these groups, we plot the group means with their 95% bootstrap confidence intervals (or ellipsoids). If the ellipses do not overlap, the groups are reliably different from each other. However, it’s worth noted that the distribution of the observations does not imply how the groups (represented by the group means) are distributed or whether the groups are reliably different from each other.\nNote: The grouping information are independent from CCA and are only use to help provide a summary description of the observations.\n\nres.cca.plot$results.graphs$lv.plot\n\n\n\n\n\n\n\n\nThe results from Dimension 1 show that the association between the chemical and the sensory data reliably separates the red wines from rose and white wines.\n\n\nContributions\nThese bar plots illustrate the signed contribution of variables from the two data tables. From these figures, we use the direction and the magnitude of these signed contributions to interpret the dimension.\nThe direction of the signed contribution is the direction of the loadings, and it shows how the variables contribute to the dimension. The variables that contribute in a similar way have the same sign, and those that contribute in an opposite way will have different signs.\nThe magnitude of the contributions are computed as squared loadings, and they quantify the amount of variance contributed by each variable. Therefore, contribution is similar to the idea of an effect size. To identify the important variables, we find the variables that contribute more than average (i.e., with a big enough effect size). When the variables are centered and scaled to have their sums of squares equals 1, each variable contributes one unit of variance; therefore, the average contribution is 1/(# of variables of the table).\n\nres.cca.plot$results.graphs$ctrX.plot\n\n\n\n\n\n\n\nres.cca.plot$results.graphs$ctrY.plot\n\n\n\n\n\n\n\n\nFrom these two bar plots, the first dimension is characterized by (1) the positive association between Alcohol and Tannin from the Chemical data and Astringent and Hedonic from the Sensory data, and (2) the negative association between these variables and Floral, Vegetal, Spicy, and Sweet from the Sensory data.\nTogether with the latent variable plot, we found that, as compared to the rose and the white wines in the sample, the red wines are less Hedonic and Astringent but stronger in Alcohol and Tannin and taste more Floral, Vegetal, Spicy, Woody, and Sweet.\n\n\nCircles of correlations\nThe circle of correlations illustrate how the variables are correlated with each other and with the dimensions. From this figure, the length of an arrow indicates how much this variable is explained by the two given dimensions. The cosine between any two arrows gives their correlation. The cosine between a variable and an axis gives the correlation between that variable and the corresponding dimension.\nIn this figure, an angle closer to 0° indicates a correlation close to 1; an angle closer to 180° indicates a correlation close to -1; and an 90° angle indicates 0 correlation. However, it’s worth noted that this implication of correlation might only be true within the given dimensions. When a variable is far away from the circle, it is not fully explained by the dimensions, and other dimensions might be characterized by other pattern of relationship between this and other variables.\n\nres.cca.plot$results.graphs$cirCorX.plot\n\n\n\n\n\n\n\nres.cca.plot$results.graphs$cirCorY.plot\n\n\n\n\n\n\n\n\nThese circles of correlations show that Alcohol, Tannin, Woody, Astringent, and Hedonic are strongly correlated to Dimension 1 with Henodic inversely correlated with all other variables. These variables are mostly explained by the first dimension and have close-to-zero correlation with the second dimension (which is not included and discussed in the previous sections)."
  },
  {
    "objectID": "pages/D_CCAonWines.html#inference-plots-and-results",
    "href": "pages/D_CCAonWines.html#inference-plots-and-results",
    "title": "Canonical Correlation Analysis on Wines",
    "section": "Inference plots and results",
    "text": "Inference plots and results\nThe inference analysis of CCA is still under development."
  },
  {
    "objectID": "pages/E_RAonWines.html",
    "href": "pages/E_RAonWines.html",
    "title": "Redundancy Analysis on Wines",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/E_RAonWines.html#load-the-course-library",
    "href": "pages/E_RAonWines.html#load-the-course-library",
    "title": "Redundancy Analysis on Wines",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/E_RAonWines.html#load-the-data",
    "href": "pages/E_RAonWines.html#load-the-data",
    "title": "Redundancy Analysis on Wines",
    "section": "Load the data",
    "text": "Load the data\nWith the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")\n\nMore information on the dataset is available on the corresponding vignette: vignette(\"A3_DataWines\")."
  },
  {
    "objectID": "pages/E_RAonWines.html#two-tables-with-descriptors-and-other-supplementary-information",
    "href": "pages/E_RAonWines.html#two-tables-with-descriptors-and-other-supplementary-information",
    "title": "Redundancy Analysis on Wines",
    "section": "Two tables with descriptors and other supplementary information",
    "text": "Two tables with descriptors and other supplementary information\n\ndescr &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(origin, color, varietal)\nsuppl &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Price)\nchemi &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Acidity, Alcohol, Sugar, Tannin)\nsenso &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(fruity, floral, vegetal, \n           spicy, woody, sweet, astringent, \n           hedonic)\n\n\nTwo data tables\n\nThe predictor table (X): chemical data (chemi) that includes acidity, alcohol, sugar, and tannin.\nThe predicted table (Y): sensory data (senso) that includes fruity, floral, vegetal, spicy, woody, sweet, astringent, and hedonic.\n\n\n\nDescriptors and supplementary variable\n\nDescriptors: origin, color and varietal.\nSupplementary variables: Price."
  },
  {
    "objectID": "pages/E_RAonWines.html#run-redundancy-analysis-ra-on-the-two-tables",
    "href": "pages/E_RAonWines.html#run-redundancy-analysis-ra-on-the-two-tables",
    "title": "Redundancy Analysis on Wines",
    "section": "Run Redundancy Analysis (RA) on the two tables",
    "text": "Run Redundancy Analysis (RA) on the two tables\nThe tepRA function takes two entries of data tables. The first entry will be the predictor table (X) and the second entry will be the predicted table (Y) as in a regression equation: \\(\\mathbf{Y = \\beta X + E}\\). In RA, the dimensions maximize \\(\\beta\\) of each pair of latent variables.\n\nres.ra &lt;- tepRA(chemi, senso, DESIGN = descr$color, graphs = FALSE)\n\nThe default of this function will center (to have means equal 0) and scale (to have the sums of squares equal 1) all variables in both data tables. The argument DESIGN indicates the groups of the observations and change how the observations are colored in the figures (when graphs = TRUE), but it does not change the results of RA."
  },
  {
    "objectID": "pages/E_RAonWines.html#generate-the-figures",
    "href": "pages/E_RAonWines.html#generate-the-figures",
    "title": "Redundancy Analysis on Wines",
    "section": "Generate the figures",
    "text": "Generate the figures\n\n## You might need to load these packages if the error is saying that it couldn't find some functions\n# library(PTCA4CATA) \n# library(data4PCCAR)\nres.ra.plot &lt;- TTAplot(\n    res = res.ra, # Output of tepPLS\n    color.obs = wineColors, # &lt;optional&gt; colors of wines\n    color.tab = varColors, # &lt;optional&gt; colors of the two tables\n    tab1.name = \"Chemical data\", # &lt;optional&gt; Name of Table 1 (for printing)\n    tab2.name = \"Sensory data\", # &lt;optional&gt; Name of Table 2 (for printing)\n    DESIGN = descr$color, # design for the wines\n    tab1 = chemi,  # First data table\n    tab2 = senso)  # Second data table\n\nIn this TTAplot function, if DESIGN is specified. The latent variables will be colored according to the groups of the observations with the group means and their 95% bootstrap confidence intervals.\n\nCorrelation between the two tables\nWe can check the data by plotting first the correlation matrix between the two data sets. This correlation matrix is where the dimensions are extracted.\n\nres.ra.plot$results.graphs$heatmap.rxy\n\n\n\n\n\n\n\n\n\n\nScree plot\nThe scree plot shows the eigenvalues of each dimension. These eigenvalues give the squared coefficient of regression (\\(\\beta^2\\) = 3.14247) of each pair of latent variables. In other words, the singular values, which are the square root of the eigenvalues, give the coefficient of regression (\\(\\beta\\) = 1.7727013) of these pairs of latent variables. The sum of the eigenvalues is equal to the sum of the squared correlation between all variables in both tables.\n\nres.ra.plot$results.graphs$scree.eig\n\n\n\n\n\n\n\n\n\n\nLatent variables\nHere, we plot the first latent variable of both tables against each other with the observations colored according to their groups. This plot shows how the observations are distributed on the dimension and how the chosen pair of latent variables are related to each other. When plotting the first pair of latent variables, we expect the observations to distribute along the bottom-left-to-top-right diagonal line (which illustrates a perfect association), because RA maximizes the coefficient of regression of the latent variables.\nTo examine the stability of these groups, we plot the group means with their 95% bootstrap confidence intervals (or ellipsoids). If the ellipses do not overlap, the groups are reliably different from each other. However, it’s worth noted that the distribution of the observations does not imply how the groups (represented by the group means) are distributed or whether the groups are reliably different from each other.\nNote: The grouping information are independent from RA and are only use to help provide a summary description of the observations.\n\nres.ra.plot$results.graphs$lv.plot\n\n\n\n\n\n\n\n\nThe results from Dimension 1 show that the chemical data can predict the performance of the sensory data, and such prediction separates the red wines from the rosé and the white wines, but not the rosé and the white.\n\n\nContributions\nThese bar plots illustrate the signed contribution of variables from the two data tables. From these figures, we use the direction and the magnitude of these signed contributions to interpret the dimension.\nThe direction of the signed contribution is the direction of the loadings, and it shows how the variables contribute to the dimension. The variables that contribute in a similar way have the same sign, and those that contribute in an opposite way will have different signs.\nThe magnitude of the contributions are computed as squared loadings, and they quantify the amount of variance contributed by each variable. Therefore, contribution is similar to the idea of an effect size. To identify the important variables, we find the variables that contribute more than average (i.e., with a big enough effect size). When the variables are centered and scaled to have their sums of squares equals 1, each variable contributes one unit of variance; therefore, the average contribution is 1/(# of variables of the table).\n\nres.ra.plot$results.graphs$ctrX.plot\n\n\n\n\n\n\n\nres.ra.plot$results.graphs$ctrY.plot\n\n\n\n\n\n\n\n\nFrom these two bar plots, the first dimension is characterized by (1) the positive association between Alcohol and Tannin from the Chemical data and Woody and Astringent from the Sensory data, and (2) the negative association between these variables and Hedonic from the Sensory data.\nTogether with the latent variable plot, we found that, as compared to the rosé and the white wines in the sample, the red wines are less Hedonic and stronger in Alcohol, Tannin, Woody, and Astringent.\n\n\nCircles of correlations\nThe circle of correlations illustrate how the variables are correlated with each other and with the dimensions. From this figure, the length of an arrow indicates how much this variable is explained by the two given dimensions. The cosine between any two arrows gives their correlation. The cosine between a variable and an axis gives the correlation between that variable and the corresponding dimension.\nIn this figure, an angle closer to 0° indicates a correlation close to 1; an angle closer to 180° indicates a correlation close to -1; and an 90° angle indicates 0 correlation. However, it’s worth noted that this implication of correlation might only be true within the given dimensions. When a variable is far away from the circle, it is not fully explained by the dimensions, and other dimensions might be characterized by other pattern of relationship between this and other variables.\n\nres.ra.plot$results.graphs$cirCorX.plot\n\n\n\n\n\n\n\nres.ra.plot$results.graphs$cirCorY.plot\n\n\n\n\n\n\n\n\nThese circles of correlations show that Alcohol, Tannin, Woody, Astringent, and Hedonic are strongly correlated to Dimension 1 with Henodic inversely correlated with all other variables. These variables are mostly explained by the first dimension and have close-to-zero correlation with the second dimension (which is not included and discussed in the previous sections)."
  },
  {
    "objectID": "pages/E_RAonWines.html#inference-plots-and-results",
    "href": "pages/E_RAonWines.html#inference-plots-and-results",
    "title": "Redundancy Analysis on Wines",
    "section": "Inference plots and results",
    "text": "Inference plots and results\nThe inference analysis of RA is still under development."
  },
  {
    "objectID": "pages/C_PLSConWines.html",
    "href": "pages/C_PLSConWines.html",
    "title": "PLSC on Wines",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/C_PLSConWines.html#load-the-course-library",
    "href": "pages/C_PLSConWines.html#load-the-course-library",
    "title": "PLSC on Wines",
    "section": "",
    "text": "library(R4SPISE2022)"
  },
  {
    "objectID": "pages/C_PLSConWines.html#load-the-data",
    "href": "pages/C_PLSConWines.html#load-the-data",
    "title": "PLSC on Wines",
    "section": "Load the data",
    "text": "Load the data\nWith the following command\n\ndata(\"winesOf3Colors\", package = \"data4PCCAR\")\n\n\nwineColors &lt;- list()\nwineColors$oc &lt;- as.matrix(as.character(recode(winesOf3Colors$winesDescriptors$color, red = 'indianred4', \n                white = 'gold', rose = 'lightpink2')))\nwineColors$gc &lt;- as.matrix(c(red = 'indianred4', \n                white = 'gold', rose = 'lightpink2'))\n\nvarColors &lt;- list()\nvarColors$oc[[1]] &lt;- as.matrix(rep(\"darkorange1\", 4))\nvarColors$oc[[2]] &lt;- as.matrix(rep(\"olivedrab3\", 8))\n    \n\nMore information on the dataset is available on the corresponding vignette: vignette(\"A3_DataWines\")."
  },
  {
    "objectID": "pages/C_PLSConWines.html#two-tables-with-descriptors-and-other-supplementary-information",
    "href": "pages/C_PLSConWines.html#two-tables-with-descriptors-and-other-supplementary-information",
    "title": "PLSC on Wines",
    "section": "Two tables with descriptors and other supplementary information",
    "text": "Two tables with descriptors and other supplementary information\n\ndescr &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(origin, color, varietal)\nsuppl &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Price)\nchemi &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(Acidity, Alcohol, Sugar, Tannin)\nsenso &lt;- winesOf3Colors$winesDescriptors %&gt;% \n    select(fruity, floral, vegetal, \n           spicy, woody, sweet, astringent, \n           hedonic)\n\n\nTwo data tables\n\nFirst table: chemical data (chemi) that includes acidity, alcohol, sugar, and tannin.\nSecond table: sensory data (senso) that includes fruity, floral, vegetal, spicy, woody, sweet, astringent, and hedonic.\n\n\n\nDescriptors and supplementary variable\n\nDescriptors: origin, color and varietal.\nSupplementary variables: Price."
  },
  {
    "objectID": "pages/C_PLSConWines.html#run-partial-least-square-correlation-pls-c-on-the-two-tables",
    "href": "pages/C_PLSConWines.html#run-partial-least-square-correlation-pls-c-on-the-two-tables",
    "title": "PLSC on Wines",
    "section": "Run Partial Least Square Correlation (PLS-C) on the two tables",
    "text": "Run Partial Least Square Correlation (PLS-C) on the two tables\n\nres.pls &lt;- tepPLS(chemi, senso, DESIGN = descr$color, graphs = FALSE)\n\nThe default of this function will center (to have means equal 0) and scale (to have the sums of squares equal 1) all variables in both data tables. The argument DESIGN indicates the groups of the observations and change how the observations are colored in the figures (when graphs = TRUE), but it does not change the results of PLS-C."
  },
  {
    "objectID": "pages/C_PLSConWines.html#generate-the-figures",
    "href": "pages/C_PLSConWines.html#generate-the-figures",
    "title": "PLSC on Wines",
    "section": "Generate the figures",
    "text": "Generate the figures\n\n## You might need to load these packages if the error is saying that it couldn't find some functions\n\nres.pls.plot &lt;- TTAplot(\n    res = res.pls, # Output of tepPLS\n    color.obs = wineColors, # &lt;optional&gt; colors of wines\n    color.tab = varColors, # &lt;optional&gt; colors of the two tables\n    tab1.name = \"Chemical data\", # &lt;optional&gt; Name of Table 1 (for printing)\n    tab2.name = \"Sensory data\", # &lt;optional&gt; Name of Table 2 (for printing)\n    DESIGN = descr$color, # design for the wines\n    tab1 = chemi,  # First data table\n    tab2 = senso)  # Second data table\n\nIn this TTAplot function, if DESIGN is specified. The latent variables will be colored according to the groups of the observations with the group means and their 95% bootstrap confidence intervals.\n\nCorrelation between the two tables\nWe can check the data by plotting first the correlation matrix between the two data sets. This correlation matrix is where the dimensions are extracted.\n\nres.pls.plot$results.graphs$heatmap.rxy\n\n\n\n\n\n\n\n\n\n\nScree plot\nThe scree plot shows the eigenvalues of each dimension. These eigenvalues give the squared covariance of each pair of latent variables. In other words, the singular values, which are the square root of the eigenvalues, give the covariance of these pairs of latent variables. The sum of the eigenvalues is equal to the sum of the squared covariance between all variables in both tables.\n\nres.pls.plot$results.graphs$scree.eig\n\n\n\n\n\n\n\n\n\n\nLatent variables\nHere, we plot the first latent variable of both tables against each other with the observations colored according to their groups. This plot shows how the observations are distributed on the dimension and how the chosen pair of latent variables are related to each other. When plotting the first pair of latent variables, we expect the observations to distribute along the bottom-left-to-top-right diagonal line (which illustrates a perfect association), because PLS-C maximizes the covariance of the latent variables.\nTo examine the stability of these groups, we plot the group means with their 95% bootstrap confidence intervals (or ellipsoids). If the ellipses do not overlap, the groups are reliably different from each other. However, it’s worth noted that the distribution of the observations does not imply how the groups (represented by the group means) are distributed or whether the groups are reliably different from each other.\nNote: The grouping information are independent from PLS-C and are only use to help provide a summary description of the observations.\n\nres.pls.plot$results.graphs$lv.plot\n\n\n\n\n\n\n\n\nThe results from Dimension 1 show that the association between the chemical and the sensory data reliably separates the red wines from rose and white wines.\n\n\nContributions\nThese bar plots illustrate the signed contribution of variables from the two data tables. From these figures, we use the direction and the magnitude of these signed contributions to interpret the dimension.\nThe direction of the signed contribution is the direction of the loadings, and it shows how the variables contribute to the dimension. The variables that contribute in a similar way have the same sign, and those that contribute in an opposite way will have different signs.\nThe magnitude of the contributions are computed as squared loadings, and they quantify the amount of variance contributed by each variable. Therefore, contribution is similar to the idea of an effect size. To identify the important variables, we find the variables that contribute more than average (i.e., with a big enough effect size). When the variables are centered and scaled to have their sums of squares equals 1, each variable contributes one unit of variance; therefore, the average contribution is 1/(# of variables of the table).\n\nres.pls.plot$results.graphs$ctrX.plot\n\n\n\n\n\n\n\nres.pls.plot$results.graphs$ctrY.plot\n\n\n\n\n\n\n\n\nFrom these two bar plots, the first dimension is characterized by (1) the positive association between Alcohol and Tannin from the Chemical data and Woody and Astringent from the Sensory data, and (2) the negative association between these variables and Hedonic from the Sensory data.\nTogether with the latent variable plot, we found that, as compared to the rose and the white wines in the sample, the red wines are less Hedonic and stronger in Alcohol, Tannin, Woody, and Astringent.\n\n\nCircles of correlations\nThe circle of correlations illustrate how the variables are correlated with each other and with the dimensions. From this figure, the length of an arrow indicates how much this variable is explained by the two given dimensions. The cosine between any two arrows gives their correlation. The cosine between a variable and an axis gives the correlation between that variable and the corresponding dimension.\nIn this figure, an angle closer to 0° indicates a correlation close to 1; an angle closer to 180° indicates a correlation close to -1; and an 90° angle indicates 0 correlation. However, it’s worth noted that this implication of correlation might only be true within the given dimensions. When a variable is far away from the circle, it is not fully explained by the dimensions, and other dimensions might be characterized by other pattern of relationship between this and other variables.\n\nres.pls.plot$results.graphs$cirCorX.plot\n\n\n\n\n\n\n\nres.pls.plot$results.graphs$cirCorY.plot\n\n\n\n\n\n\n\n\nThese circles of correlations show that Alcohol, Tannin, Woody, Astringent, and Hedonic are strongly correlated to Dimension 1 with Henodic inversely correlated with all other variables. These variables are mostly explained by the first dimension and have close-to-zero correlation with the second dimension (which is not included and discussed in the previous sections)."
  },
  {
    "objectID": "pages/C_PLSConWines.html#inference-plots-and-results",
    "href": "pages/C_PLSConWines.html#inference-plots-and-results",
    "title": "PLSC on Wines",
    "section": "Inference plots and results",
    "text": "Inference plots and results\nThe inference analysis of PCA (performed by OTAplotInference) includes bootstrap test of the proportion of variance explained, permutation tests of the eigenvalues, the bootstrap tests of the loadings (i.e., the left and the right singular vectors).\n\nres.plot.plsc.inference &lt;- TTAplotInference(\n    res = res.pls,\n    tab1 = chemi, \n    tab2 = senso, \n    DESIGN = descr$color,\n    tab1.name = \"Chemical data\", # &lt;optional&gt; Name of Table 1 (for printing)\n    tab2.name = \"Sensory data\" # &lt;optional&gt; Name of Table 2 (for printing)    \n    )\n\n\nBootstrap and permutation tests on the eigenvalues\nThe inference scree plot illustrates the 95% bootstrap confidence intervals of the eigenvalues. If an interval includes 0, the eigenvalue is reliably larger than 0.\n\nres.plot.plsc.inference$results.graphs$scree\n\n\n\n\n\n\n\n\nThe bootstrap test identifies two significant dimensions having eigenvalues reliably larger than 0. The permutation test identifies two significant dimensions with eigenvalues significantly larger than 0.\n\n\nBootstrap test on the loadings\nThe bar plot illustrates the bootstrap ratios which equals \\[\\frac{M_{p_{j}boot}}{SD_{p_{j}boot}},\\] where \\(M_{p_{j}boot}\\) is the mean of the bootstrapped sample of the jth loading and \\(SD_{p_{j}boot}\\) is the bootstrapped standard deviation of the factor score. A bootstrap ratio is equivalent to a t-statistics for the column factor score with the \\(\\mathrm{H}_0: g_j = 0\\). The threshold is set to 2 to approximate the critical t-value of 1.96 at \\(\\alpha\\) = .05.\n\nres.plot.plsc.inference$results.graphs$BR.X\n\n\n\n\n\n\n\n\nThe bootstrap test identifies Alcohol, Sugar, and Tannin as chemical variables with loadings significantly different from 0.\n\nres.plot.plsc.inference$results.graphs$BR.Y\n\n\n\n\n\n\n\n\nThe bootstrap test identifies Floral, Spicy, Woody, Sweet, Astringent and Hedonic as significant sensory variables with loadings different from 0.\nIt’s worth noted that the bootstrap ratio gives different information as contributions. Contributions describe the size of the effect, and the bootstrap ratios describe the reliability of the loadings. Therefore, when we interpret the results, we will combine both to draw a conclusion.\n\nInterpreting loadings with contributions and bootstrap ratios\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe results from the Chemical data show that Alcohol, Sugar, and Tannin all have loadings stably (or significantly) different from 0. But, only Alcohol and Tannin contribute a significant amount of variance to this dimension. Although the loading of Sugar is stable and is significant different from 0, the effect size is small; in other words, it’s not considered as important.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSimilarly, for the Sensory data, the results show that Floral, Spicy, Woody, Sweet, Astringent and Hedonic all have loadings stably (or significantly) different from 0. But, only Woody, Astringent, and Hedoniccontribute a significant amount of variance to this dimension. In other words, the loadings of Floral, Spicy, Woody, Sweet, Astringent and Hedonic are stable and reliably different from 0, but the important variables that define this dimension are Woody, Astringent, and Hedonic."
  }
]